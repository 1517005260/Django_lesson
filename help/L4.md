# *lesson 4*

1.本节课主要用js实现游戏逻辑，可以参考[拳皇](https://github.com/1517005260/KOF)的制作过程

整体开发方向：`在playground中创建基类gameobject+实现简易游戏引擎`->

`完善场景类playground`->

`创建地图类gamemap`->

`创建玩家类和技能类`->

`创建技能的粒子效果`->

`区分敌人和自己，并为敌人添加简单的ai逻辑`

[别人的笔记](https://www.acwing.com/solution/content/79181/)

2.修改上节课的`web.html`文件，把其中在`<head>`标签中引用的js改变为下部`module`中`import`进来，防止出现全局变量重名、改变等各种问题

记得在`class Game`面前加上`export`

3.这次在修改`export`时，遇到了改完后空白页面的bug，解决方法：强制刷新网页，即`<ctrl>+<shift>+<R>`

4.有关`ctx`的理解：`ctx`是`CanvasRenderingContext2D `的简写，一般写为`this.ctx=this.$canvas[0].getContext('2d');`,通过`ctx`，我们可以访问到`canvas`的各种api，`例子：this.ctx.fillRect(参数)`。然而，`ctx`本身是个抽象对象，并不具备具象的`width`等属性，因此若想调用`ctx`指向的`canvas`的长宽属性，我们需要`this.ctx.canvas.width`。

# 注意访问具体属性的时候不是`$canvas`而是`canvas`

5.有关小球模糊拖尾的效果实现：`当物体移动时，如果Canvas的背景是半透明的黑色，那么在物体移动的轨迹上，不断新绘制的物体会与之前绘制的半透明黑色背景叠加。由于半透明黑色背景有透明度，新绘制的物体颜色会与背景颜色混合，导致颜色逐渐变淡，从而产生模糊或拖尾的效果。这种效果类似于在动画制作中，每帧都叠加一层半透明的黑色蒙版（透明黑色），使得物体逐渐消失，给人一种动态模糊的感觉。`

6.有关小球的移动：本项目采用右键移动（类英雄联盟）。为了实现这个效果，

首先我们需要禁用掉鼠标右键弹出的菜单，即在`function`中`return false`即可。

接着，我们需要绑定监听事件`e.which === 3` (其中1=左键，2=滚轮，3=右键)来实现指定目的地。

最后实现移动的效果：向量法  `(x1,y1)->(x2,y2)` 由欧几里得距离可得向量的长度，由`atan2(y,x)`即arctan可求`θ`。在单位圆中利用cos和sin可求得vx和vy的方向。

7.有关脚本合成js代码：由于`GameObject`是所有类的基类，所以要优先定义，因此可以将它的文件夹名前面加上`A`便于检索

8.游戏的所有参数可以自行调整

9.拼写问题：
# 本次写代码时发现多次destory的拼写问题，应为destroy